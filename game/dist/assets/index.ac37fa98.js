var le=Object.defineProperty,de=Object.defineProperties;var ce=Object.getOwnPropertyDescriptors;var J=Object.getOwnPropertySymbols;var he=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable;var z=(n,e,t)=>e in n?le(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,h=(n,e)=>{for(var t in e||(e={}))he.call(e,t)&&z(n,t,e[t]);if(J)for(var t of J(e))ue.call(e,t)&&z(n,t,e[t]);return n},R=(n,e)=>de(n,ce(e));var B=(n,e,t)=>(z(n,typeof e!="symbol"?e+"":e,t),t);import{G as Q,N as ee,T,D as C,v as ge,s as Ee,V as we,a as te,I as se,C as p,S as L,b as W,f as q,c as F,R as Te,w as pe,A as Se,i as Ae,d as Re}from"./vendor.c5e9b697.js";const Ce=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}};Ce();class Ne{constructor(e){this.app=e,this.stage=e.stage,this.scenes={},this.activeScene=""}add(e,t){t.sceneManager=this,this.scenes[e]=t}display(e){const t=this.scenes[e];t.loaded||t.load(),this.activeScene!==e&&this.activeScene!==""&&this.scenes[this.activeScene].destroy(),this.stage.addChild(t.container),this.activeScene=e}redraw(){const e=this.scenes[this.activeScene];e.destroy(),e.load(),this.stage.addChild(e.container)}}class Oe{constructor(e){B(this,"app");B(this,"resouces");B(this,"container");B(this,"sceneManager");B(this,"loaded");B(this,"displayObjects");this.app=e.app,this.resources=e.resources,this.loaded=!1,this.displayObjects={}}destroy(){this.container.destroy(),this.loaded=!1,this.displayObjects={}}load(){throw new Error("Not Implemented")}draw(){throw new Error("Not Implemented")}}class P extends Oe{constructor(e){super(e);B(this,"store");B(this,"tiles");B(this,"titles");this.store=e.store,this.tiles=this.resources["assets/tiles/tiles.json"].spritesheet.textures,this.titles=this.resources["assets/titles/titles.json"].spritesheet.textures}}const w={fontFamily:"Ghoulish",fontSize:36,fill:"white",stroke:"black",strokeThickness:3,dropShadow:!0,dropShadowBlur:3,dropShadowDistance:3},j={gray:6052956,green:6205522,yellow:13943620},fe=new Q({outerStrength:0,innerStrength:2,color:0,distance:30}),x=(n,e)=>{const t=new ee(n,15,15,15,15);t.interactive=!0,t.buttonMode=!0,t.down=!1,e.width&&(t.width=e.width),e.height&&(t.height=e.height);const i=e.filters?e.filters:[];i.length&&(t.filters=i);const s=()=>{t.down=!0,t.filters=[...i,fe]},o=()=>{t.down&&(t.down=!1,t.filters=[...i])};if(t.on("pointerdown",s),t.on("pointerup",o),t.on("pointerout",o),e.labelText){const r=e.textStyle?e.textStyle:w,c=new T(e.labelText,r);t.addChild(c),c.anchor.set(.5),e.width||(t.width=c.width+75),c.position.set(t.width/2,t.height/2)}return t},g={PUG:"PUG",BUTTERFLY:"BUTTERFLY",TURTLE:"TURTLE",KITTEN:"KITTEN",ORCA:"ORCA",ELK:"ELK",PENGUIN:"PENGUIN",DUCKLING:"DUCKLING",GORILLA:"GORILLA",LION:"LION",PANDA:"PANDA",ELEPHANT:"ELEPHANT",BEAR:"BEAR",SHARK:"SHARK",BLOBFISH:"BLOBFISH",NAKEDMOLERAT:"NAKEDMOLERAT"},Le=[g.PUG,g.BUTTERFLY,g.TURTLE,g.KITTEN,g.ORCA,g.ELK,g.PENGUIN,g.DUCKLING,g.GORILLA,g.LION,g.PANDA,g.ELEPHANT,g.BEAR,g.SHARK,g.BLOBFISH,g.NAKEDMOLERAT],N={COMMON:"COMMON",UNCOMMON:"UNCOMMON",RARE:"RARE",SUPER_RARE:"SUPER_RARE",EPIC:"EPIC"},be={[g.PUG]:N.COMMON,[g.BUTTERFLY]:N.COMMON,[g.TURTLE]:N.COMMON,[g.KITTEN]:N.COMMON,[g.ORCA]:N.UNCOMMON,[g.ELK]:N.UNCOMMON,[g.PENGUIN]:N.UNCOMMON,[g.DUCKLING]:N.UNCOMMON,[g.GORILLA]:N.RARE,[g.LION]:N.RARE,[g.PANDA]:N.RARE,[g.ELEPHANT]:N.RARE,[g.BEAR]:N.SUPER_RARE,[g.SHARK]:N.SUPER_RARE,[g.BLOBFISH]:N.EPIC,[g.NAKEDMOLERAT]:N.EPIC},_e="secret",me={[N.COMMON]:new C("0.25"),[N.UNCOMMON]:new C("0.25"),[N.RARE]:new C("0.25"),[N.SUPER_RARE]:new C("0.125"),[N.EPIC]:new C("0.125")},ne=new C("1.1"),Ie=(n,e)=>ne.div(e).mul(n),ye=(n,e)=>{const t=e==null?ge():e,i=`${t}:${_e}`,s=Ee(i),o=50,r=Array.from({length:o},()=>n[Math.floor(s()*n.length)]);return{uuid:t,board:r}},Be=(n,e)=>{const t=ye(Le),s=t.board.map((d,l)=>{const u=e[l];let S=new C(0),O=null,f=null,a=null;return u===be[d]?(f=me[u],a=u):u===d&&(f="0.0625",a="ANIMAL"),a!==null&&(S=Ie(n,f),O=`${ne.div(f).toFixed(1)}x`),{won:S,multiplier:O,hitType:a}}),o=e.filter(d=>d!==null).length,r=new C(n).mul(o),c=s.reduce((d,l)=>l.won.add(d),0);return{bet:n,resultsBoard:s,generatedBoard:t,squaresBet:o,totalBet:r,totalWon:c}},xe=n=>{const e=1e6;return{_id:"0x0000000000000000",hits:0,balance:e,winnings:"0",wagers:"0",rollover:e,deposits:e,lastDepositBlock:0,games:[],withdraws:[]}},Me=n=>{const{bet:e,board:t}=n.body,i=n.user,s=Be(e,t),{totalBet:o,totalWon:r,squaresBet:c}=s;if(new C(e).lt(1))return{err:"Bet too small"};if(new C(e).gt(2e5))return{err:"Bet too large"};if(c===0)return{err:"No tiles bet"};const d=new C(i.balance).sub(o).add(r).toString(),l=s.resultsBoard.filter(A=>A.hitType!==null).length,u=new C(i.winnings).add(r).toString(),S=new C(i.wagers).add(o).toString(),O=new C(i.rollover),f=O.lte(o)?"0":O.sub(o).toString(),a={balance:d,rollover:f,winnings:u,wagers:S,hits:i.hits+l};return{results:s,user:a}},E={PUG:"PUG",BUTTERFLY:"BUTTERFLY",TURTLE:"TURTLE",KITTEN:"KITTEN",ORCA:"ORCA",ELK:"ELK",PENGUIN:"PENGUIN",DUCKLING:"DUCKLING",GORILLA:"GORILLA",LION:"LION",PANDA:"PANDA",ELEPHANT:"ELEPHANT",BEAR:"BEAR",SHARK:"SHARK",BLOBFISH:"BLOBFISH",NAKEDMOLERAT:"NAKEDMOLERAT"},Ue=[E.PUG,E.BUTTERFLY,E.TURTLE,E.KITTEN,E.ORCA,E.ELK,E.PENGUIN,E.DUCKLING,E.GORILLA,E.LION,E.PANDA,E.ELEPHANT,E.BEAR,E.SHARK,E.BLOBFISH,E.NAKEDMOLERAT],ie={[E.PUG]:"pugTile.png",[E.BUTTERFLY]:"butterflyTile.png",[E.TURTLE]:"turtleTile.png",[E.KITTEN]:"kittenTile.png",[E.ORCA]:"orcaTile.png",[E.ELK]:"elkTile.png",[E.PENGUIN]:"penguinTile.png",[E.DUCKLING]:"ducklingTile.png",[E.GORILLA]:"gorillaTile.png",[E.LION]:"lionTile.png",[E.PANDA]:"pandaTile.png",[E.ELEPHANT]:"elephantTile.png",[E.BEAR]:"bearTile.png",[E.SHARK]:"sharkTile.png",[E.BLOBFISH]:"blobfishTile.png",[E.NAKEDMOLERAT]:"nakedmoleratTile.png"},y="wager",b={SET_SELECTED_GUESS_KEY:"SET_SELECTED_GUESS_KEY",SET_GUESS_AT_INDEX:"SET_GUESS_AT_INDEX",SET_RENTALS:"SET_RENTALS",CLEAR_GUESS_BOARD:"CLEAR_GUESS_BOARD",SET_WAGER_INCREMENT:"SET_WAGER_INCREMENT",INCREMENT_WAGER:"INCREMENT_WAGER",DECREMENT_WAGER:"DECREMENT_WAGER"},k={GUESS_TILES:"GUESS_TILES",TOTAL_GUESSES:"TOTAL_GUESSES"},Ge={namespaced:!0,state:()=>({selectedGuessKey:null,guessBoard:Array.from({length:50},()=>null),wager:1e3,wagerIncrement:1e3,wagerMin:1,wagerMax:2e5,rentals:null,guessTileTextures:R(h({},ie),{COMMON:"commonTile.png",UNCOMMON:"uncommonTile.png",RARE:"rareTile.png",SUPER_RARE:"superrareTile.png",EPIC:"epicTile.png"})}),mutations:{[b.SET_SELECTED_GUESS_KEY]:(n,e)=>{n.selectedGuessKey=e},[b.SET_RENTALS]:(n,e)=>{n.rentals=h({},e)},[b.CLEAR_GUESS_BOARD]:n=>{n.guessBoard=Array.from({length:50},()=>null)},[b.SET_GUESS_AT_INDEX]:(n,{index:e,guess:t})=>{n.guessBoard[e]=t},[b.SET_WAGER_INCREMENT]:(n,e)=>{n.wagerIncrement=e},[b.INCREMENT_WAGER]:n=>{n.wager+=n.wagerIncrement,n.wager>n.wagerMax&&(n.wager=n.wagerMax)},[b.DECREMENT_WAGER]:n=>{n.wager-=n.wagerIncrement,n.wager<n.wagerMin&&(n.wager=n.wagerMin)}},getters:{[k.GUESS_TILES]:n=>{const e=["COMMON","UNCOMMON","RARE","SUPER_RARE","EPIC"].map(t=>({key:t,textureKey:n.guessTileTextures[t]}));return Ue.map(t=>({key:t,textureKey:n.guessTileTextures[t]})).concat(e)},[k.TOTAL_GUESSES]:n=>n.guessBoard.filter(e=>e!==null).length}},_={SET_SESSION:"SET_SESSION",SET_LAST_BOARD:"SET_LAST_BOARD",SET_BALANCE:"SET_BALANCE",SET_ROUND_RESULTS:"SET_ROUND_RESULTS",SET_WALLET:"SET_WALLET",SET_ROLLOVER:"SET_ROLLOVER",SET_TXN_PENDING:"SET_TXN_PENDING",SET_LOADING_TEXT:"SET_LOADING_TEXT"},U={CONNECT:"CONNECT",PLAY:"PLAY",WITHDRAW:"WITHDRAW",FETCH_SESSION_DATA:"FETCH_SESSION_DATA"},De=new we.Store({state:()=>({session:null,roundResults:null,txnPending:!1,loadingText:"Loading..."}),mutations:{[_.SET_SESSION]:(n,e)=>{n.session=h({},e)},[_.SET_BALANCE]:(n,e)=>{n.session.balance=e},[_.SET_ROUND_RESULTS]:(n,e)=>{n.roundResults=h({},e)},[_.SET_WALLET]:(n,e)=>{n.wallet=e},[_.SET_ROLLOVER]:(n,e)=>{n.session.rollover=e},[_.SET_TXN_PENDING]:(n,e)=>{n.txnPending=e},[_.SET_LOADING_TEXT]:(n,e)=>{n.loadingText=e}},actions:{[U.CONNECT]:({commit:n})=>new Promise((e,t)=>{const i=xe();n(_.SET_SESSION,i),n(_.SET_WALLET,i._id),e()}),[U.FETCH_SESSION_DATA]:({commit:n})=>new Promise((e,t)=>{const i={url:"/hatchscratcher/session",baseURL:{}.VITE_API_URL,method:"GET",withCredentials:!0};te(i).then(s=>n(_.SET_SESSION,s.data)).then(()=>e()).catch(t)}),[U.PLAY]:({commit:n,state:e})=>new Promise((t,i)=>{const s={user:e.session,body:{bet:e.wager.wager,board:e.wager.guessBoard}},{results:o,user:r}=Me(s);n(_.SET_ROUND_RESULTS,o),n(_.SET_BALANCE,r.balance),n(_.SET_ROLLOVER,r.rollover),t()}),[U.WITHDRAW]:({dispatch:n,commit:e,state:t})=>new Promise((i,s)=>{const o={baseURL:{}.VITE_API_URL,url:"/hatchscratcher/session/withdraw",method:"POST",withCredentials:!0};te(o).then(r=>{const{hash:c}=r.data;alert("Transaction Hash: "+c)}).then(()=>n(U.FETCH_SESSION_DATA)).then(()=>i()).catch(s)})},modules:{[y]:Ge}}),m={popclick:"/assets/sounds/popclick.wav",choice:"/assets/sounds/choice.wav",remove:"/assets/sounds/remove.wav",fairy:"/assets/sounds/fairy.wav",win:"/assets/sounds/win.wav"};Object.values(m).forEach(n=>{se.add(n,n)});const I=async n=>{se.play(n)};class Pe extends P{constructor(e){super(e)}load(){this.container=new p;const e=new L(this.resources["assets/images/splash.png"].texture);this.container.addChild(e);const t=x(this.tiles["button9s.png"],{labelText:"Login",filters:[new W]});this.container.addChild(t),t.position.set(e.width/2-t.width/2,e.height/2+150),t.on("pointerup",()=>{I(m.popclick),this.store.commit(_.SET_LOADING_TEXT,`Loading Account...
${window.walletAddress}`),this.sceneManager.display("loading"),this.store.dispatch(U.CONNECT).then(()=>this.sceneManager.display("wager")).catch(i=>{i.response&&alert(i.response.data),this.sceneManager.display("connect")})})}}class ve extends P{constructor(e){super(e)}load(){this.container=new p;const e=new L(this.resources["assets/images/background.png"].texture);this.container.addChild(e);const t=this.buildModal();this.container.addChild(t),t.position.set(e.width/2-t.width/2,e.height/2-t.height/2+30)}buildModal(){const e=new p;e.filters=[new W({distance:20,blur:5})];const t=new L(this.resources["assets/images/results.png"].texture);e.addChild(t);const i=this.store.state.roundResults.resultsBoard,s={BASE_ANIMALS:{title:"Animals",hits:i.filter(a=>a.hitType==="ANIMAL").length,sum:i.filter(a=>a.hitType==="ANIMAL").reduce((a,A)=>new C(a).add(A.won),0)},EPIC:{title:"Epics",hits:i.filter(a=>a.hitType==="EPIC").length,sum:i.filter(a=>a.hitType==="EPIC").reduce((a,A)=>new C(a).add(A.won),0)},SUPER_RARE:{title:"Super Rares",hits:i.filter(a=>a.hitType==="SUPER_RARE").length,sum:i.filter(a=>a.hitType==="SUPER_RARE").reduce((a,A)=>new C(a).add(A.won),0)},RARE:{title:"Rares",hits:i.filter(a=>a.hitType==="RARE").length,sum:i.filter(a=>a.hitType==="RARE").reduce((a,A)=>new C(a).add(A.won),0)},UNCOMMON:{title:"Uncommons",hits:i.filter(a=>a.hitType==="UNCOMMON").length,sum:i.filter(a=>a.hitType==="UNCOMMON").reduce((a,A)=>new C(a).add(A.won),0)},COMMON:{title:"Commons",hits:i.filter(a=>a.hitType==="COMMON").length,sum:i.filter(a=>a.hitType==="COMMON").reduce((a,A)=>new C(a).add(A.won),0)}};Object.keys(s).forEach((a,A)=>{const{title:D,hits:M,sum:re}=s[a],v=new p,ae=new T(D,R(h({},w),{fontSize:28}));v.addChild(ae);const $=new T(M,R(h({},w),{fontSize:28,fill:M===0?j.gray:j.green}));v.addChild($),$.position.set(245,0);const Y=new T(`+ ${Number(re).toLocaleString("en-US")} $ZOO`,R(h({},w),{fontSize:28,fill:M===0?j.gray:j.yellow}));v.addChild(Y),Y.position.set($.x+270-Y.width,0),e.addChild(v),v.position.set(90,150+v.height*A+A)});const o=this.store.state.roundResults.totalBet,r=this.store.state.roundResults.squaresBet,c=new C(o).div(r),d=new T("Total Wagered",R(h({},w),{fontSize:28}));e.addChild(d),d.position.set(90,370);const l=new T(`${Number(o).toLocaleString("en-US")} $ZOO`,R(h({},w),{fontSize:28}));e.addChild(l),l.position.set(610-l.width,370);const u=new T(`${Number(c).toLocaleString("en-US")} $ZOO/sq`,R(h({},w),{fontSize:28}));e.addChild(u),u.position.set(610-u.width,405);const S=Object.values(s).reduce((a,A)=>new C(a).add(A.sum),0),O=new T(`${Number(S).toLocaleString("en-US")} $ZOO`,R(h({},w),{fontSize:64,strokeThickness:6}));e.addChild(O),O.position.set(e.width/2-O.width/2+10,600);const f=x(this.tiles["button9s.png"],{labelText:"Play Again",filters:[new W]});return e.addChild(f),f.position.set(e.width/2-f.width/2,680),f.on("pointerdown",()=>{I(m.popclick),this.sceneManager.display("wager")}),e}}const V=new q.ColorMatrixFilter;V.brightness(.5);V.blackAndWhite(!0);const X=new q.NoiseFilter;X.noise=.1;X.resolution=4;const K=new F;K.beginFill(16777215);K.drawCircle(0,0,30);K.endFill();K.cacheAsBitmap=!0;class Ke extends P{constructor(e){super(e);B(this,"winningBoard")}load(){this.container=new p;const e=this.buildScene();this.container.addChild(e)}buildScene(){const e=new p,t=new L(this.resources["assets/images/background.png"].texture);e.addChild(t);const i=new L(this.titles["title.png"]);e.addChild(i),i.position.set(20,0);const s=new T("Start Scratching!",R(h({},w),{fontSize:72}));e.addChild(s),s.anchor.set(.5),s.position.set(this.app.screen.width/2,230);const o=new F;o.lineStyle(3,0,.7),o.beginFill(0,.25),o.drawRoundedRect(26,340,715,365,8),o.endFill(),e.addChild(o);const r=this.buildScratcher();e.addChild(r),r.position.set(this.app.screen.width/2-r.width/2,350);const c=x(this.tiles["button9s.png"],{labelText:"View Results",textStyle:R(h({},w),{fontSize:64}),height:120});return e.addChild(c),c.position.set(this.app.screen.width/2-c.width/2,800),c.on("pointerdown",this.scratchAll.bind(this)),e}buildWinningBoard(){const e=this.store.state.roundResults,t=e.generatedBoard.board,i=e.resultsBoard,s=new p,o=new p;s.addChild(o),o.filters=[X];const r=5,c=10;for(let d=0;d<t.length;d++){const l=new L(this.tiles[ie[t[d]]]);if(i[d].hitType===null)l.filters=[V];else{const u=new T(i[d].multiplier,R(h({},w),{fill:j.yellow,fontSize:32}));u.anchor.set(.5),l.addChild(u),u.position.set(l.width/2,l.height-u.height/2)}o.addChild(l),l.position.set(d%c*l.width+d%c*r,Math.floor(d/c)*l.height+Math.floor(d/c)*r)}return s}buildScratchableBoard(){const e=new p,t=new p;e.addChild(t);const i=5,s=10;for(let o=0;o<50;o++){const r=new L(this.tiles["eggTile.png"]);t.addChild(r),r.position.set(o%s*r.width+o%s*i,Math.floor(o/s)*r.height+Math.floor(o/s)*i)}return e}buildScratcher(){const e=new p,t=this.buildScratchableBoard();e.addChild(t),this.winningBoard=this.buildWinningBoard(),e.addChild(this.winningBoard);const i=Te.create({width:this.winningBoard.width,height:this.winningBoard.height}),s=new L(i);e.addChild(s),this.winningBoard.mask=s;let o=!1;const r=l=>{o&&(s.toLocal(l.data.global,null,K),this.app.renderer.render(K,{renderTexture:i,clear:!1}))},c=l=>{o=!0,r(l)},d=l=>{o=!1};return s.interactive=!0,s.on("pointerdown",c),s.on("pointerup",d),s.on("pointermove",r),e}scratchAll(){I(m.win),this.sceneManager.display("results")}}class We extends P{constructor(e){super(e)}load(){this.container=new p;const e=new L(this.resources["assets/images/splash.png"].texture);this.container.addChild(e);const t=new T("Loading...",R(h({},w),{fontSize:48}));this.container.addChild(t),t.anchor.set(.5),t.position.set(e.width/2+10,e.height/2+150),this.loaded=!0}}const je=new W,Z=new Q({distance:25,color:16771584,innerStrength:4,outerStrength:0}),oe=new q.ColorMatrixFilter;oe.brightness(.3);oe.blackAndWhite(!0);class Fe extends P{constructor(e){super(e)}load(){this.setupStore(),this.displayObjects={rentalText:{},guessBoardTiles:[],selectedGuessKeyButton:null,selectedIncrementorButton:null,totalValueText:null},this.container=new p;const e=new L(this.resources["assets/images/background.png"].texture);this.container.addChild(e);const t=new L(this.titles["title.png"]);this.container.addChild(t),t.position.set(20,0);const i=this.buildGuessButtons();this.container.addChild(i),i.position.set(e.width/2-i.width/2,155);const s=this.buildGuessBoard();this.container.addChild(s),s.position.set(e.width/2-s.width/2,385);const o=this.buildWagerContainer();this.container.addChild(o),o.position.set(e.width/2-s.width/2,770);const r=this.buildWalletContainer();this.container.addChild(r),r.scale.set(.7),r.position.set(30,e.height-r.height)}setupStore(){this.store.commit([y,b.SET_SELECTED_GUESS_KEY].join("/"),null)}buildGuessButtons(){const e=new p;e.filters=[je];const t=5,i=8,s=this.store.getters[[y,k.GUESS_TILES].join("/")];for(let r=0;r<s.length;r++){const c=s[r],d=new L(this.tiles[c.textureKey]);d.interactive=!0,d.buttonMode=!0,d.filters=[],e.addChild(d),d.position.set(r%i*d.width+r%i*t,Math.floor(r/i)*d.height+Math.floor(r/i)*t);const l=()=>{c.key===this.store.state.wager.selectedGuessKey?(d.filters=[],this.store.commit([y,b.SET_SELECTED_GUESS_KEY].join("/"),null),this.displayObjects.selectedGuessKeyButton=null,I(m.remove)):(this.displayObjects.selectedGuessKeyButton!==null&&(this.displayObjects.selectedGuessKeyButton.filters=[]),d.filters=[Z],this.store.commit([y,b.SET_SELECTED_GUESS_KEY].join("/"),c.key),this.displayObjects.selectedGuessKeyButton=d,I(m.choice))};d.on("pointerdown",l)}const o=x(this.tiles["button9s.png"],{labelText:"Clear Board",width:this.tiles["animal.png"].width*3+t*2});return e.addChild(o),o.position.set(e.width-o.width,e.height-o.height),o.on("pointerup",()=>{I(m.remove),this.store.commit([y,b.CLEAR_GUESS_BOARD].join("/")),this.sceneManager.redraw()}),e}buildGuessBoard(){const e=new p;let t=!1;const i=new F;i.lineStyle(3,0,.7),i.beginFill(0,.25),i.drawRoundedRect(0,0,715,365,8),i.endFill(),e.addChild(i);const s=new p;e.addChild(s),s.position.set(10,10);const o=5,r=10,c=this.store.state.wager.guessBoard,d=this.store.state.wager.guessTileTextures;for(let l=0;l<c.length;l++){const u=c[l]===null?this.tiles["questionTile.png"]:this.tiles[d[c[l]]],S=new L(u);S.interactive=!0,S.buttonMode=!0,s.addChild(S),S.position.set(l%r*S.width+l%r*o,Math.floor(l/r)*S.height+Math.floor(l/r)*o);const O=()=>{t=!0,f()},f=()=>{if(t){const{selectedGuessKey:a,guessTileTextures:A}=this.store.state.wager,D=this.displayObjects.guessBoardTiles[l],M=this.store.state.wager.guessBoard[l];a===null||M===a?(this.store.commit([y,b.SET_GUESS_AT_INDEX].join("/"),{index:l,guess:null}),D.texture=this.tiles["questionTile.png"],I(m.remove)):(this.store.commit([y,b.SET_GUESS_AT_INDEX].join("/"),{index:l,guess:a}),D.texture=this.tiles[A[a]],I(m.popclick)),this.refreshTotalText()}};S.on("pointerdown",O),S.on("pointerup",()=>{t=!1}),S.on("pointerover",f),this.displayObjects.guessBoardTiles.push(S)}return i.interactive=!0,i.on("pointerdown",()=>t=!0),i.on("pointerup",()=>t=!1),i.on("pointerout",l=>{i.containsPoint(l.data.global)||(t=!1)}),e}buildWagerContainer(){const e=new p,t=new F;t.lineStyle(3,0,.7),t.beginFill(0,.25),t.drawRoundedRect(0,0,715,185,8),t.endFill(),e.addChild(t);const i=new p;e.addChild(i),i.position.set(10,0);const s=new p;i.addChild(s);const o=new T("Wager:",w);s.addChild(o);const r=new T("NaN",R(h({},w),{fill:9689064}));s.addChild(r),r.position.set(o.width+5,o.y+2),this.displayObjects.wagerText=r;const c=new T("$ZOO/sq",R(h({},w),{fontSize:24}));s.addChild(c),c.position.set(r.x+r.width+5,r.y+r.height-c.height-3),this.displayObjects.wagerSubtitle=c;const d=new T("Total:",w);s.addChild(d),d.y=o.y+o.height-5;const l=new T("X $ZOO",R(h({},w),{fontSize:24}));s.addChild(l),l.y=d.y+d.height-l.height-3,l.x=d.x+d.width+10,this.displayObjects.totalValueText=l;const u=new p;e.addChild(u),u.x=5,u.y=s.y+s.height;const S=x(this.tiles["button9s.png"],{labelText:"--",textStyle:R(h({},w),{fontSize:72}),width:155,height:50});u.addChild(S),S.on("pointerdown",()=>{I(m.popclick),this.store.commit([y,b.DECREMENT_WAGER].join("/")),this.refreshWagerText()});const O=x(this.tiles["button9s.png"],{labelText:"++",textStyle:R(h({},w),{fontSize:72}),width:155,height:50});u.addChild(O),O.x=S.width+5,O.on("pointerdown",()=>{I(m.popclick),this.store.commit([y,b.INCREMENT_WAGER].join("/")),this.refreshWagerText()}),[{title:"1",value:1},{title:"100",value:100},{title:"1K",value:1e3,active:!0},{title:"10K",value:1e4}].forEach((A,D)=>{const M=this.buildWagerButton(A.value,A.title,{width:75,height:50});u.addChild(M),M.position.set(D*75+D*5,S.y+S.height+5)});const a=x(this.tiles["button9s.png"],{labelText:"Begin Round",textStyle:R(h({},w),{fontSize:64}),height:e.height-20,width:370});return e.addChild(a),a.position.set(e.width-a.width-13,10),a.on("pointerdown",()=>{I(m.popclick),this.store.commit(_.SET_LOADING_TEXT,"We're Getting Ready!"),this.sceneManager.display("loading"),this.store.dispatch(U.PLAY).then(()=>{I(m.fairy),this.sceneManager.display("scratcher")}).catch(A=>{A.response&&alert(A.response.data),this.sceneManager.display("wager")})}),this.refreshWagerText(),e}buildWalletContainer(){const e=new p,t=x(this.tiles["button9s.png"],{labelText:"Withdraw"});e.addChild(t),t.on("pointerup",()=>{I(m.popclick),this.store.commit(_.SET_LOADING_TEXT,"Processing Withdrawal..."),this.sceneManager.display("loading"),this.store.dispatch(U.WITHDRAW).catch(u=>{u.response&&alert(u.response.data)}).finally(()=>this.sceneManager.display("wager"))});const{balance:i}=this.store.state.session,s=this.store.state.session._id,o=Number(i).toLocaleString("en-US"),r=new T(`Balance: ${o} $ZOO | Wallet: ${s.slice(0,5)}...${s.slice(s.length-4)}`,h({},w));e.addChild(r),r.position.set(t.x+t.width+10,t.y-5);const{rollover:c}=this.store.state.session,d=Number(c).toLocaleString("en-US"),l=new T(`Rollover: ${d} $ZOO Remaining`,h({},w));return e.addChild(l),l.position.set(t.x+t.width+10,r.y+r.height),e}refreshWagerText(){const e=this.displayObjects.wagerText,t=this.displayObjects.wagerSubtitle,i=Number(this.store.state.wager.wager).toLocaleString("en-US");e.text=i,t.position.set(e.x+e.width+5,e.y+e.height-t.height-3),this.refreshTotalText()}refreshTotalText(){const e=this.displayObjects.totalValueText,t=this.store.getters[[y,k.TOTAL_GUESSES].join("/")];e.text=(this.store.state.wager.wager*t).toLocaleString("en-US")+" $ZOO"}rebuildLastBoard(){this.store.state.lastBoard.forEach((e,t)=>{this.displayObjects.guessBoardTiles[t].texture=e===null?this.tiles["questionTile.png"]:this.tiles[this.guessTextures[e]],this.guessBoard[t]=e})}buildWagerButton(e,t,i){const s=new ee(this.tiles["button9s.png"],15,15,15,15);s.interactive=!0,s.buttonMode=!0,s.down=!1,i.width&&(s.width=i.width),i.height&&(s.height=i.height),e===this.store.state.wager.wagerIncrement&&(s.filters=[Z],this.displayObjects.selectedIncrementorButton=s);const o=new T(t,R(h({},w),{fontSize:30}));s.addChild(o),o.anchor.set(.5),o.position.set(s.width/2,s.height/2);const r=()=>{I(m.choice),this.store.commit([y,b.SET_WAGER_INCREMENT].join("/"),e),this.displayObjects.selectedIncrementorButton.filters=[],this.displayObjects.selectedIncrementorButton=s,s.filters=[Z]};return s.on("pointerdown",r),s}}class ke extends P{constructor(e){super(e)}load(){this.container=new p;const e=new L(this.resources["assets/images/splash.png"].texture);this.container.addChild(e);const t=new p;this.container.addChild(t);const i=new L(this.tiles["eggTileWhite.png"]);t.addChild(i),i.anchor.set(.5),this.app.ticker.add(o=>{i.rotation+=.1*o});const s=new T(this.store.state.loadingText,R(h({},w),{align:"center"}));t.addChild(s),s.anchor.set(.5),s.position.set(i.x,i.height+25),t.position.set(e.width/2,e.height/2+175)}}class He extends P{constructor(e){super(e)}load(){this.container=new p;const e=new L(this.resources["assets/images/background.png"].texture);this.container.addChild(e);const t=new L(this.resources["assets/images/rollover.png"].texture);this.container.addChild(t),t.filters=[new W],t.position.set(e.width/2-t.width/2,e.height/2-t.height/2+50);const i=new T(`You must wager the entirety of
your deposit prior to
withdrawing your game balance`,R(h({},w),{align:"center"}));t.addChild(i),i.position.set(t.width/2-i.width/2,140);const s=new p;t.addChild(s),s.position.set(85,276);const o=new T("Total Deposits",h({},w));s.addChild(o);const r=new T("NAN $ZOO",R(h({},w),{align:"right"}));s.addChild(r),r.position.set(525-r.width,o.y);const c=new p;t.addChild(c),c.position.set(85,336);const d=new T("Total Wagered",h({},w));c.addChild(d);const l=new T("NAN $ZOO",R(h({},w),{align:"right"}));c.addChild(l),l.position.set(525-l.width,d.y);const u=new p;t.addChild(u),u.position.set(85,396);const S=new T("Remaining",h({},w));u.addChild(S);const O=new T("NAN $ZOO",R(h({},w),{align:"right"}));u.addChild(O),O.position.set(525-O.width,S.y);const f=x(this.tiles["button9s.png"],{labelText:"Continue"});t.addChild(f),f.position.set(t.width/2-f.width/2,600)}}pe.exports.load({custom:{families:["Ghoulish"],urls:["/assets/GhoulFriAOE.ttf"]}});const H=new Se({width:768,height:1024,resolution:1,backgroundColor:"0x3F9BD4"}),$e=document.querySelector("#canvas-container");$e.appendChild(H.view);const Ye=Ae()?"WebGL":"canvas";Re(Ye);const G=new Ne(H);H.loader.add("assets/images/background.png","/assets/images/background.png").add("assets/images/results.png","/assets/images/results.png").add("assets/images/rollover.png","/assets/images/rollover.png").add("assets/images/splash.png","/assets/images/splash.png").add("assets/tiles/tiles.json","/assets/tiles/tiles.json").add("assets/titles/titles.json","/assets/titles/titles.json").add("assets/previews/previews.json","/assets/previews/previews.json").load(ze);function ze(n,e){const t={app:H,resources:e,store:De};G.add("splash",new We(t)),G.add("connect",new Pe(t)),G.add("wager",new Fe(t)),G.add("scratcher",new Ke(t)),G.add("results",new ve(t)),G.add("loading",new ke(t)),G.add("rollover",new He(t)),qe()}async function qe(){G.display("connect")}window.addEventListener("message",n=>{const{walletAddress:e}=n.data;e&&(window.walletAddress=e)});
